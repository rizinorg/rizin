NAME=save and load debug session (dtst, dtsf)
FILE=bins/elf/analysis/calls_x64
ARGS=-d
CMDS=<<EOF
dcu main
dts+
ds 200
dtst ./
dtsf ./
dr rip
ds 10
dr rip
rm ./session.sdb
rm ./registers.sdb
rm ./memory.sdb
rm ./checkpoints.sdb
EOF
EXPECT=<<EOF
0x00400574
0x00400565
EOF
RUN

NAME=stop trace session (dts-)
FILE=bins/elf/analysis/calls_x64
ARGS=-d -e dbg.bpsysign=true
BROKEN=1
CMDS=<<EOF
dcu main
dts+
ds
ds
ds
ds
dts-
ds
ds
dt
EOF
EXPECT=<<EOF
0x00400574 size=7 count=1 times=1 tag=0
0x00400575 size=10 count=2 times=1 tag=0
0x0040052f size=2 count=3 times=1 tag=0
0x00400539 size=10 count=4 times=1 tag=0
0x0040053c size=2 count=5 times=1 tag=0
EOF
RUN