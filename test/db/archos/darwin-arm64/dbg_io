NAME=io_mach read
FILE=bins/mach0/mapper-macos-arm64
ARGS=-d
CMDS=<<EOF
dcu sym._continue_until_here
px 0x10 @ 0x10000000000-0x7
px 0x10 @ 0x10000000000
px 0x100 @ 0x10000003fe1
dk 9
EOF
EXPECT=<<EOF
- offset -     0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0xfffffffff9  ffff ffff ffff ff54 6869 7320 6973 206d  .......This is m
- offset -      0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x10000000000  5468 6973 2069 7320 6d79 206d 6170 0000  This is my map..
- offset -      0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x10000003fe1  2062 7574 2066 6967 6874 2061 6e64 2073   but fight and s
0x10000003ff1  686f 7574 2061 6e64 2074 6561 7273 2eff  hout and tears..
0x10000004001  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x10000004011  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x10000004021  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x10000004031  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x10000004041  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x10000004051  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x10000004061  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x10000004071  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x10000004081  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x10000004091  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x100000040a1  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x100000040b1  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x100000040c1  ffff ffff ffff ffff ffff ffff ffff ffff  ................
0x100000040d1  ffff ffff ffff ffff ffff ffff ffff ffff  ................
EOF
RUN
