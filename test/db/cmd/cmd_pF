NAME=pFa ASN1 decoding of a certificate
FILE=malloc://4096
CMDS=<<EOF
w6d MIIEkjCCA3qgAwIBAgIQCgFBQgAAAVOFc2oLheynCDANBgkqhkiG9w0BAQsFADA/MSQwIgYDVQQKExtEaWdpdGFsIFNpZ25hdHVyZSBUcnVzdCBDby4xFzAVBgNVBAMTDkRTVCBSb290IENBIFgzMB4XDTE2MDMxNzE2NDA0NloXDTIxMDMxNzE2NDA0NlowSjELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUxldCdzIEVuY3J5cHQxIzAhBgNVBAMTGkxldCdzIEVuY3J5cHQgQXV0aG9yaXR5IFgzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnNMM8FrlLke3cl03g7NoYzDq1zUmGSXhvb418XCSL7e4S0EFq6meNQhY7LEqxGiHC6PjdeTm86dicbp5gWAf15Gan/PQeGdxyGkOlZHP/uaZ6WA8SMx+yk13EiSdRxta67nsHjcAHJyse6cF6s5K671B5TaYucv9bTyWaN8jKkKQDIZ0Z8h/pZq4UmEUEz9l6YKHy9v6Dlb2honzhT+Xhq+w3Brvaw2VFn3EK6BlspkENnWAa6xK8xuQSXgvopZPKiAlKQTGdMDQMc2PMTiVFrqoM7hD8bEfwzB/onkxEz0tNvjj/PIzark5McWvxI0NHWQWM6r6hCm21AvA2H3DkwIDAQABo4IBfTCCAXkwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAYYwfwYIKwYBBQUHAQEEczBxMDIGCCsGAQUFBzABhiZodHRwOi8vaXNyZy50cnVzdGlkLm9jc3AuaWRlbnRydXN0LmNvbTA7BggrBgEFBQcwAoYvaHR0cDovL2FwcHMuaWRlbnRydXN0LmNvbS9yb290cy9kc3Ryb290Y2F4My5wN2MwHwYDVR0jBBgwFoAUxKexpHsscfrb4UuQdf/EFWCFiRAwVAYDVR0gBE0wSzAIBgZngQwBAgEwPwYLKwYBBAGC3xMBAQEwMDAuBggrBgEFBQcCARYiaHR0cDovL2Nwcy5yb290LXgxLmxldHNlbmNyeXB0Lm9yZzA8BgNVHR8ENTAzMDGgL6AthitodHRwOi8vY3JsLmlkZW50cnVzdC5jb20vRFNUUk9PVENBWDNDUkwuY3JsMB0GA1UdDgQWBBSoSmpjBH3duubRObemRWXv86jsoTANBgkqhkiG9w0BAQsFAAOCAQEA3TPXEfNjWDjdGBX7CVW+dla5cEilaUcne8IkCJLxWh9KEik3JHRRHGJouM2VcGfl96S8TihRzZvoroed6ti6WqEBmtzw3Wodatg+VyOeph4EYpr/1wXKtx8/wApIvJSwtmVi4MFU5aMqrSDE6ea73Mj2tcMyo5jMd6jmeWUHK8so/joWUoHOUgwuX4Po1QYz+3dszkDqMp4fklxBwXRsW10KXzPMTZ+sOPAveyxindmjkW8lGy+QsRlGPfZ+G6Z6h7mjem0Y+iWlkYcV4PIWL1iwBi8saCbGS5jN2p8M+X+Q7UNKEkROb3N6KOqkqm57TH2H3eDJAkSnh6/DNFu0Qg==
b 0x1000
pFa
pFaq
EOF
EXPECT=<<EOF
   0  1170: 0: cons SEQUENCE            : 
   4   890: 1: cons SEQUENCE            : 
   8     3: 2: cons Context [0]         : 
  10     1: 3: prim INTEGER             : 02
  13    16: 2: prim INTEGER             : 0a 01 41 42 00 00 01 53 85 73 6a 0b 85 ec a7 08 |..AB...S.sj.....|
  31    13: 2: cons SEQUENCE            : 
  33     9: 3: prim OBJECT_IDENTIFIER   : sha256WithRSAEncryption
  46    63: 2: cons SEQUENCE            : 
  48    36: 3: cons SET                 : 
  50    34: 4: cons SEQUENCE            : 
  52     3: 5: prim OBJECT_IDENTIFIER   : organizationName
  57    27: 5: prim PrintableString     : Digital Signature Trust Co.
  86    23: 3: cons SET                 : 
  88    21: 4: cons SEQUENCE            : 
  90     3: 5: prim OBJECT_IDENTIFIER   : commonName
  95    14: 5: prim PrintableString     : DST Root CA X3
 111    30: 2: cons SEQUENCE            : 
 113    13: 3: prim UTCTime             : 17/03/2016 16:40:46 GMT
 128    13: 3: prim UTCTime             : 17/03/2021 16:40:46 GMT
 143    74: 2: cons SEQUENCE            : 
 145    11: 3: cons SET                 : 
 147     9: 4: cons SEQUENCE            : 
 149     3: 5: prim OBJECT_IDENTIFIER   : countryName
 154     2: 5: prim PrintableString     : US
 158    22: 3: cons SET                 : 
 160    20: 4: cons SEQUENCE            : 
 162     3: 5: prim OBJECT_IDENTIFIER   : organizationName
 167    13: 5: prim PrintableString     : Let's Encrypt
 182    35: 3: cons SET                 : 
 184    33: 4: cons SEQUENCE            : 
 186     3: 5: prim OBJECT_IDENTIFIER   : commonName
 191    26: 5: prim PrintableString     : Let's Encrypt Authority X3
 219   290: 2: cons SEQUENCE            : 
 223    13: 3: cons SEQUENCE            : 
 225     9: 4: prim OBJECT_IDENTIFIER   : rsaEncryption
 238   270: 3: prim BIT_STRING          : 
 243   266: 4: cons SEQUENCE            : 
 247   257: 5: prim INTEGER             : 00 9c d3 0c f0 5a e5 2e 47 b7 72 5d 37 83 b3 68 |.....Z..G.r]7..h|
                                        : 63 30 ea d7 35 26 19 25 e1 bd be 35 f1 70 92 2f |c0..5&.%...5.p./|
                                        : b7 b8 4b 41 05 ab a9 9e 35 08 58 ec b1 2a c4 68 |..KA....5.X..*.h|
                                        : 87 0b a3 e3 75 e4 e6 f3 a7 62 71 ba 79 81 60 1f |....u....bq.y.`.|
                                        : d7 91 9a 9f f3 d0 78 67 71 c8 69 0e 95 91 cf fe |......xgq.i.....|
                                        : e6 99 e9 60 3c 48 cc 7e ca 4d 77 12 24 9d 47 1b |...`<H.~.Mw.$.G.|
                                        : 5a eb b9 ec 1e 37 00 1c 9c ac 7b a7 05 ea ce 4a |Z....7....{....J|
                                        : eb bd 41 e5 36 98 b9 cb fd 6d 3c 96 68 df 23 2a |..A.6....m<.h.#*|
                                        : 42 90 0c 86 74 67 c8 7f a5 9a b8 52 61 14 13 3f |B...tg.....Ra..?|
                                        : 65 e9 82 87 cb db fa 0e 56 f6 86 89 f3 85 3f 97 |e.......V.....?.|
                                        : 86 af b0 dc 1a ef 6b 0d 95 16 7d c4 2b a0 65 b2 |......k...}.+.e.|
                                        : 99 04 36 75 80 6b ac 4a f3 1b 90 49 78 2f a2 96 |..6u.k.J...Ix/..|
                                        : 4f 2a 20 25 29 04 c6 74 c0 d0 31 cd 8f 31 38 95 |O* %)..t..1..18.|
                                        : 16 ba a8 33 b8 43 f1 b1 1f c3 30 7f a2 79 31 13 |...3.C....0..y1.|
                                        : 3d 2d 36 f8 e3 fc f2 33 6a b9 39 31 c5 af c4 8d |=-6....3j.91....|
                                        : 0d 1d 64 16 33 aa fa 84 29 b6 d4 0b c0 d8 7d c3 |..d.3...).....}.|
                                        : 93                                              |.               |
 508     3: 5: prim INTEGER             : 010001
 513   381: 2: cons Context [3]         : 
 517   377: 3: cons SEQUENCE            : 
 521    18: 4: cons SEQUENCE            : 
 523     3: 5: prim OBJECT_IDENTIFIER   : basicConstraints
 528     1: 5: prim BOOLEAN             : true
 531     8: 5: prim OCTET_STRING        : 
 533     6: 6: cons SEQUENCE            : 
 535     1: 7: prim BOOLEAN             : true
 538     1: 7: prim INTEGER             : 00
 541    14: 4: cons SEQUENCE            : 
 543     3: 5: prim OBJECT_IDENTIFIER   : keyUsage
 548     1: 5: prim BOOLEAN             : true
 551     4: 5: prim OCTET_STRING        : 
 553     2: 6: prim BIT_STRING          : 0186
 557   127: 4: cons SEQUENCE            : 
 559     8: 5: prim OBJECT_IDENTIFIER   : authorityInfoAccess
 569   115: 5: prim OCTET_STRING        : 
 571   113: 6: cons SEQUENCE            : 
 573    50: 7: cons SEQUENCE            : 
 575     8: 8: prim OBJECT_IDENTIFIER   : ocsp
 585    38: 8: prim Context [6]         : 
 625    59: 7: cons SEQUENCE            : 
 627     8: 8: prim OBJECT_IDENTIFIER   : caIssuers
 637    47: 8: prim Context [6]         : 
 686    31: 4: cons SEQUENCE            : 
 688     3: 5: prim OBJECT_IDENTIFIER   : authorityKeyIdentifier
 693    24: 5: prim OCTET_STRING        : 
 695    22: 6: cons SEQUENCE            : 
 697    20: 7: prim Context [0]         : 
 719    84: 4: cons SEQUENCE            : 
 721     3: 5: prim OBJECT_IDENTIFIER   : certificatePolicies
 726    77: 5: prim OCTET_STRING        : 
 728    75: 6: cons SEQUENCE            : 
 730     8: 7: cons SEQUENCE            : 
 732     6: 8: prim OBJECT_IDENTIFIER   : domain-validated
 740    63: 7: cons SEQUENCE            : 
 742    11: 8: prim OBJECT_IDENTIFIER   : 1.3.6.1.4.1.44947.1.1.1
 755    48: 8: cons SEQUENCE            : 
 757    46: 9: cons SEQUENCE            : 
 759     8:10: prim OBJECT_IDENTIFIER   : cps
 769    34:10: prim IA5String           : http://cps.root-x1.letsencrypt.org
 805    60: 4: cons SEQUENCE            : 
 807     3: 5: prim OBJECT_IDENTIFIER   : cRLDistributionPoints
 812    53: 5: prim OCTET_STRING        : 
 814    51: 6: cons SEQUENCE            : 
 816    49: 7: cons SEQUENCE            : 
 818    47: 8: cons Context [0]         : 
 820    45: 9: cons Context [0]         : 
 822    43:10: prim Context [6]         : 
 867    29: 4: cons SEQUENCE            : 
 869     3: 5: prim OBJECT_IDENTIFIER   : subjectKeyIdentifier
 874    22: 5: prim OCTET_STRING        : 
 876    20: 6: prim OCTET_STRING        : a8 4a 6a 63 04 7d dd ba e6 d1 39 b7 a6 45 65 ef |.Jjc.}....9..Ee.|
                                        : f3 a8 ec a1                                     |....            |
 898    13: 1: cons SEQUENCE            : 
 900     9: 2: prim OBJECT_IDENTIFIER   : sha256WithRSAEncryption
 913   256: 1: prim BIT_STRING          : 
 918    51: 2: prim Private_29          : 
    INTEGER
        02
  INTEGER
    0a 01 41 42 00 00 01 53 85 73 6a 0b 85 ec a7 08 |..AB...S.sj.....|
    sha256WithRSAEncryption
        organizationName
        Digital Signature Trust Co.
        commonName
        DST Root CA X3
    17/03/2016 16:40:46 GMT
    17/03/2021 16:40:46 GMT
        countryName
        US
        organizationName
        Let's Encrypt
        commonName
        Let's Encrypt Authority X3
      rsaEncryption
        INTEGER
          00 9c d3 0c f0 5a e5 2e 47 b7 72 5d 37 83 b3 68 |.....Z..G.r]7..h|
          63 30 ea d7 35 26 19 25 e1 bd be 35 f1 70 92 2f |c0..5&.%...5.p./|
          b7 b8 4b 41 05 ab a9 9e 35 08 58 ec b1 2a c4 68 |..KA....5.X..*.h|
          87 0b a3 e3 75 e4 e6 f3 a7 62 71 ba 79 81 60 1f |....u....bq.y.`.|
          d7 91 9a 9f f3 d0 78 67 71 c8 69 0e 95 91 cf fe |......xgq.i.....|
          e6 99 e9 60 3c 48 cc 7e ca 4d 77 12 24 9d 47 1b |...`<H.~.Mw.$.G.|
          5a eb b9 ec 1e 37 00 1c 9c ac 7b a7 05 ea ce 4a |Z....7....{....J|
          eb bd 41 e5 36 98 b9 cb fd 6d 3c 96 68 df 23 2a |..A.6....m<.h.#*|
          42 90 0c 86 74 67 c8 7f a5 9a b8 52 61 14 13 3f |B...tg.....Ra..?|
          65 e9 82 87 cb db fa 0e 56 f6 86 89 f3 85 3f 97 |e.......V.....?.|
          86 af b0 dc 1a ef 6b 0d 95 16 7d c4 2b a0 65 b2 |......k...}.+.e.|
          99 04 36 75 80 6b ac 4a f3 1b 90 49 78 2f a2 96 |..6u.k.J...Ix/..|
          4f 2a 20 25 29 04 c6 74 c0 d0 31 cd 8f 31 38 95 |O* %)..t..1..18.|
          16 ba a8 33 b8 43 f1 b1 1f c3 30 7f a2 79 31 13 |...3.C....0..y1.|
          3d 2d 36 f8 e3 fc f2 33 6a b9 39 31 c5 af c4 8d |=-6....3j.91....|
          0d 1d 64 16 33 aa fa 84 29 b6 d4 0b c0 d8 7d c3 |..d.3...).....}.|
          93                                              |.               |
        INTEGER
                010001
        basicConstraints
        true
            true
            INTEGER
                        00
        keyUsage
        true
                    0186
        authorityInfoAccess
              ocsp
              caIssuers
        authorityKeyIdentifier
        certificatePolicies
              domain-validated
              1.3.6.1.4.1.44947.1.1.1
                  cps
                  http://cps.root-x1.letsencrypt.org
        cRLDistributionPoints
        subjectKeyIdentifier
            a8 4a 6a 63 04 7d dd ba e6 d1 39 b7 a6 45 65 ef |.Jjc.}....9..Ee.|
            f3 a8 ec a1                                     |....            |
  sha256WithRSAEncryption
EOF
RUN

NAME=pFx x509 decoding
FILE=malloc://4096
CMDS=<<EOF
w6d MIIEkjCCA3qgAwIBAgIQCgFBQgAAAVOFc2oLheynCDANBgkqhkiG9w0BAQsFADA/MSQwIgYDVQQKExtEaWdpdGFsIFNpZ25hdHVyZSBUcnVzdCBDby4xFzAVBgNVBAMTDkRTVCBSb290IENBIFgzMB4XDTE2MDMxNzE2NDA0NloXDTIxMDMxNzE2NDA0NlowSjELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUxldCdzIEVuY3J5cHQxIzAhBgNVBAMTGkxldCdzIEVuY3J5cHQgQXV0aG9yaXR5IFgzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnNMM8FrlLke3cl03g7NoYzDq1zUmGSXhvb418XCSL7e4S0EFq6meNQhY7LEqxGiHC6PjdeTm86dicbp5gWAf15Gan/PQeGdxyGkOlZHP/uaZ6WA8SMx+yk13EiSdRxta67nsHjcAHJyse6cF6s5K671B5TaYucv9bTyWaN8jKkKQDIZ0Z8h/pZq4UmEUEz9l6YKHy9v6Dlb2honzhT+Xhq+w3Brvaw2VFn3EK6BlspkENnWAa6xK8xuQSXgvopZPKiAlKQTGdMDQMc2PMTiVFrqoM7hD8bEfwzB/onkxEz0tNvjj/PIzark5McWvxI0NHWQWM6r6hCm21AvA2H3DkwIDAQABo4IBfTCCAXkwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAYYwfwYIKwYBBQUHAQEEczBxMDIGCCsGAQUFBzABhiZodHRwOi8vaXNyZy50cnVzdGlkLm9jc3AuaWRlbnRydXN0LmNvbTA7BggrBgEFBQcwAoYvaHR0cDovL2FwcHMuaWRlbnRydXN0LmNvbS9yb290cy9kc3Ryb290Y2F4My5wN2MwHwYDVR0jBBgwFoAUxKexpHsscfrb4UuQdf/EFWCFiRAwVAYDVR0gBE0wSzAIBgZngQwBAgEwPwYLKwYBBAGC3xMBAQEwMDAuBggrBgEFBQcCARYiaHR0cDovL2Nwcy5yb290LXgxLmxldHNlbmNyeXB0Lm9yZzA8BgNVHR8ENTAzMDGgL6AthitodHRwOi8vY3JsLmlkZW50cnVzdC5jb20vRFNUUk9PVENBWDNDUkwuY3JsMB0GA1UdDgQWBBSoSmpjBH3duubRObemRWXv86jsoTANBgkqhkiG9w0BAQsFAAOCAQEA3TPXEfNjWDjdGBX7CVW+dla5cEilaUcne8IkCJLxWh9KEik3JHRRHGJouM2VcGfl96S8TihRzZvoroed6ti6WqEBmtzw3Wodatg+VyOeph4EYpr/1wXKtx8/wApIvJSwtmVi4MFU5aMqrSDE6ea73Mj2tcMyo5jMd6jmeWUHK8so/joWUoHOUgwuX4Po1QYz+3dszkDqMp4fklxBwXRsW10KXzPMTZ+sOPAveyxindmjkW8lGy+QsRlGPfZ+G6Z6h7mjem0Y+iWlkYcV4PIWL1iwBi8saCbGS5jN2p8M+X+Q7UNKEkROb3N6KOqkqm57TH2H3eDJAkSnh6/DNFu0Qg==
b 0x1000
pFx
EOF
EXPECT=<<EOF
TBSCertificate:
  Version: v3
  Serial Number:
    0a:01:41:42:00:00:01:53:85:73:6a:0b:85:ec:a7:08
  Signature Algorithm:
    sha256WithRSAEncryption
  Issuer:
    organizationName: Digital Signature Trust Co.
    commonName: DST Root CA X3
  Validity:
    Not Before: 17/03/2016 16:40:46 GMT
    Not After: 17/03/2021 16:40:46 GMT
  Subject:
    countryName: US
    organizationName: Let's Encrypt
    commonName: Let's Encrypt Authority X3
  Subject Public Key Info:
    Algorithm: rsaEncryption
    Module: 01:00:01
    Exponent: 256 bytes
  Extensions:
    basicConstraints: critical
    8 bytes
    keyUsage: critical
    4 bytes
    authorityInfoAccess: 
    115 bytes
    authorityKeyIdentifier: 
    24 bytes
    certificatePolicies: 
    77 bytes
    cRLDistributionPoints: 
    53 bytes
    subjectKeyIdentifier: 
    22 bytes
Algorithm:
  sha256WithRSAEncryption
Signature: 256 bytes
EOF
RUN

NAME=pFx PKCS7 decoding
FILE=malloc://4096
CMDS=<<EOF
w6d MIIDVgYJKoZIhvcNAQcCoIIDRzCCA0MCAQExCTAHBgUrDgMCGjAcBgkqhkiG9w0BBwGgDwQNV2UgdGhlIFBlb3BsZaCCAdkwggHVMIIBQKADAgECAgRpuDctMAsGCSqGSIb3DQEBCzApMRAwDgYDVQQKEwdBY21lIENvMRUwEwYDVQQDEwxFZGRhcmQgU3RhcmswHhcNMTUwNTA2MDQyNDQ4WhcNMTYwNTA2MDQyNDQ4WjAlMRAwDgYDVQQKEwdBY21lIENvMREwDwYDVQQDEwhKb24gU25vdzCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAqr+tTF4mZP5rMwlXp1y+crRtFpuLXF1zvBZiYMfIvAHwo1ta8E1IcyEPJ1jIiKMcwbzeo6kAmZzIJRCTezq9jwXUsKbQTvcfOH9HmjUmXBRWFXZYoQs/OaaFa45deHmwEeMQkuSWEtYiVKKZXtJOtflKIT3MryJEDiiItMkdybUCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgCgMAsGCSqGSIb3DQEBCwOBgQDK1EweZWRL+f7Z+J0kVzY8zXptcBaV4Lf5wGZJLJVUgp33bpLNpT3yadS++XQJ+cvtW3wADQzBSTMduyOF8Zf+L7TjjrQ2+F2HbNbKUhBQKudxTfv9dJHdKbD+ngCCdQJYkIy2YexsoNG0C8nQkggyaxZd/J69xDVx6pui3Sj8sDGCATYwggEyAgEBMDEwKTEQMA4GA1UEChMHQWNtZSBDbzEVMBMGA1UEAxMMRWRkYXJkIFN0YXJrAgRpuDctMAcGBSsOAwIaoGEwGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAgBgkqhkiG9w0BCQUxExcRMTUwNTA2MDAyNDQ4LTA0MDAwIwYJKoZIhvcNAQkEMRYEFG9D7gcTh9zfKiYNJ1lgB0yTh4sZMAsGCSqGSIb3DQEBAQSBgFF3sGDU9PtXty/QMtpcFa35vvIOqmWQAIZt93XAskQOnBq4OloXiL9Ct7t1m4pzjRm0o9nDkbaSLZe7HKASHdCqijroScGlI8M+alJ8drHSFv6ZIjnMFIwIf0B2Lko6nh9/6mUXq7tbbIHa3Gd1JUVire/QFFtmgRXMbXYk8SIS
b 0x1000
pFp
EOF
EXPECT=<<EOF
signedData
  Version: v1
  Digest Algorithms:
    sha1
  Certificates: 1
    TBSCertificate:
      Version: v3
      Serial Number:
        69:b8:37:2d
      Signature Algorithm:
        sha256WithRSAEncryption
      Issuer:
        organizationName: Acme Co
        commonName: Eddard Stark
      Validity:
        Not Before: 06/05/2015 04:24:48 GMT
        Not After: 06/05/2016 04:24:48 GMT
      Subject:
        organizationName: Acme Co
        commonName: Jon Snow
      Subject Public Key Info:
        Algorithm: rsaEncryption
        Module: 01:00:01
        Exponent: 128 bytes
      Extensions:
        keyUsage: critical
        4 bytes
    Algorithm:
      sha256WithRSAEncryption
    Signature: 128 bytes
  SignerInfos:
    SignerInfo:
      Version: v2
      Issuer
        organizationName: Acme Co
        commonName: Eddard Stark
      Serial Number:
        69:b8:37:2d
      Digest Algorithm:
        sha1
      Authenticated Attributes:
        contentType: 11 bytes
        signingTime: 19 bytes
        messageDigest: 22 bytes
      Digest Encryption Algorithm
        rsaEncryption
      Encrypted Digest: 4 bytes
      Unauthenticated Attributes:
EOF
RUN

