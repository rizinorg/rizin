NAME=load without file
FILE=bins/elf/crackme0x05
CMDS=<<EOF
e cfg.newshell=1
f a_nice_refreshing_un-moisten @ 0x080483d8
Ps .tmp_load_without_file.rzdb
o
?e --
o--
o
pdi 3 @ 0x080483d8
?e --
Poo .tmp_load_without_file.rzdb
rm .tmp_load_without_file.rzdb
o
?e --
pdi 3 @ 0x080483d8
EOF
EXPECT=<<EOF
 3 * r-x 0x00001de8 bins/elf/crackme0x05
 4 - rw- 0x00000004 null://4
--
0x080483d8                   ff  invalid
0x080483d9                   ff  invalid
0x080483da                   ff  invalid
--
--
0x080483d8   a_nice_refreshing_un_moisten:
0x080483d8                   ff  invalid
0x080483d9                   ff  invalid
0x080483da                   ff  invalid
EOF
RUN

NAME=load on top of file
FILE=bins/elf/crackme0x05
CMDS=<<EOF
e cfg.newshell=1
f a_nice_refreshing_un-moisten @ 0x080483d8
Ps .tmp_load_on_top_of_file.rzdb
o
?e --
o--
o
pdi 3 @ 0x080483d8
?e --
o bins/elf/crackme0x00b
Poo .tmp_load_on_top_of_file.rzdb
rm .tmp_load_on_top_of_file.rzdb
?e --
pdi 3 @ 0x080483d8
EOF
EXPECT=<<EOF
 3 * r-x 0x00001de8 bins/elf/crackme0x05
 4 - rw- 0x00000004 null://4
--
0x080483d8                   ff  invalid
0x080483d9                   ff  invalid
0x080483da                   ff  invalid
--
--
0x080483d8   a_nice_refreshing_un_moisten:
0x080483d8                 0000  add byte [eax], al
0x080483da                 00e9  add cl, ch
0x080483dc                   90  nop
EOF
RUN

NAME=flags
FILE=bins/elf/crackme0x05
CMDS=<<EOF
e cfg.newshell=1
fr sym.main sym.renamedmain
f~?
f~main
Ps .tmp_flags.rzdb
?e --
o--
f
?e --
Po .tmp_flags.rzdb
rm .tmp_flags.rzdb
f~?
f~main
EOF
EXPECT=<<EOF
117
0x08048364 16 sym.imp.__libc_start_main
0x08048540 256 main
0x08048540 92 sym.renamedmain
0x0804a000 4 reloc.__libc_start_main
--
--
117
0x08048364 16 sym.imp.__libc_start_main
0x08048540 92 sym.renamedmain
0x08048540 256 main
0x0804a000 4 reloc.__libc_start_main
EOF
RUN

NAME=config
FILE=-
CMDS=<<EOF
e cfg.newshell=1
e asm.describe=1
e asm.describe
e asm.indentspace=8
e asm.indentspace
e anal.fcnprefix=myfunctions
e anal.fcnprefix
Ps .tmp_config.rzdb
?e --
e asm.describe=0
e asm.describe
e asm.indentspace=0
e asm.indentspace
e anal.fcnprefix=fcn
e anal.fcnprefix
?e --
Po .tmp_config.rzdb
rm .tmp_config.rzdb
e asm.describe
e asm.indentspace
e anal.fcnprefix
EOF
EXPECT=<<EOF
true
8
myfunctions
--
false
0
fcn
--
true
8
myfunctions
EOF
RUN

NAME=seek
FILE=-
CMDS=<<EOF
e cfg.newshell=1
s 0x1337
s
Ps .tmp_seek.rzdb
o--
s 0
Po .tmp_seek.rzdb
rm .tmp_seek.rzdb
s
EOF
EXPECT=<<EOF
0x1337
0x1337
EOF
RUN

NAME=anal
FILE=-
CMDS=<<EOF
e cfg.newshell=1
af+ 0x100 windowpane
afb+ windowpane 0x100 0x30
afl
Ps .tmp_anal.rzdb
?e --
o--
afl
?e --
Po .tmp_anal.rzdb
rm .tmp_anal.rzdb
afl
EOF
EXPECT=<<EOF
0x00000100    1 48           windowpane
--
--
0x00000100    1 48           windowpane
EOF
RUN
