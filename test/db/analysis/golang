NAME=Resolve all symbols on a stripped linux go1.18 binary
FILE=bins/golang/example-server-1.18-stripped
CMDS=<<EOF
aalg
fl~sym.go.~?
pdfs @ main ~str.
izq~?
EOF
EXPECT=<<EOF
4759
0x0063dfb2 str.
0x0063dfdc str.server.crt
0x0063e01e str.Reading_server_certificate:__s
0x0063e1d1 str.https:__localhost:8000
0x0063e20e str.Failed_get:__s
0x0063e2e4 str.Failed_reading_response_body:__s
0x0063e3af str.Got_response__d:__s__s
0x0063e426 str.
0x0063e48f str.
0x0063e49b str.version
0x0063e4ac str.HTTP_version
0x0063e4e5 str.
0x0063e616 str.
14210
EOF
RUN

NAME=Resolve all symbols on a stripped linux go1.16 binary
FILE=bins/golang/example-server-1.16-stripped
CMDS=<<EOF
aalg
fl~sym.go.~?
pdfs @ main ~str.
izq~?
EOF
EXPECT=<<EOF
4657
0x0066d583 str.server.crt
0x0066d5f3 str.Reading_server_certificate:__s
0x0066d722 str.https:__localhost:8000
0x0066d77c str.Failed_get:__s
0x0066d863 str.Failed_reading_response_body:__s
0x0066d9a3 str.Got_response__d:__s__s
0x0066db8c str.version
0x0066dbaa str.HTTP_version
0x0066e68d str.Addr
;-- str.flag:
;-- str.sort:
;-- str.sync:
13349
EOF
RUN

NAME=Resolve all symbols on a stripped linux go1.12 binary
FILE=bins/golang/example-server-1.12-stripped
CMDS=<<EOF
aalg
fl~sym.go.~?
pdfs @ main ~str.
izq~?
EOF
EXPECT=<<EOF
5406
0x0065d876 str.server.crt
0x0065d8e0 str.Reading_server_certificate:__s
0x0065da03 str.https:__localhost:8000
0x0065da57 str.Failed_get:__s
0x0065db5a str.Failed_reading_response_body:__s
0x0065dca5 str.Got_response__d:__s__s
0x0065de6d str.version
0x0065de8a str.HTTP_version
13489
EOF
RUN

NAME=Resolve all symbols on a linux go1.16 binary (arm32)
FILE=bins/golang/btcctl-linux-armv7-v0.22.0-beta
CMDS=<<EOF
aalg
fl~sym.go.~?
pdfs @ main ~str.
izq~?
EOF
EXPECT=<<EOF
5124
0x00270aac str.Failed_to_read_data_from_stdin:__v
0x00270d70 str.s_command:__v
0x00270db8 str.1.0
0x002710ec str.Failed_to_unmarshal_result:__v
0x0027124c str.Failed_to_format_result:__v
0x00271338 str.PH2
0x0027140c str.s_command:__v__code:__s
0x002714b0 str.The___s__command_can_only_be_used_via_websockets
0x00271580 str.Unrecognized_command___s
0x00271608 str.No_command_specified
0x0027186c str.Chain_Server_Commands:DEBUG_HTTP2
0x0027187c str.Wallet_Server_Commands____wallet_:
0x00271ab4 str.PH2
0x00271bbc str.cannot_use__wallet_with__regtest__btcwallet_not_yet_compatible_with_regtest
0x00271e10 str.localhost
0x00272018 str.Use__s__h_to_show_options
0x002720ec str.btcwallet.conf
0x00272188 str.Error_creating_a_default_config_file:__v
0x00272618 str.s:_Multiple_network_params_can_t_be_used_together____choose_one
0x0027271c str.Error_parsing_config_file:__v
0x002727f8 str.btcd.conf
0x00272c0c str.m___s_rpcuser_____s
0x00272c60 str.m___s_rpcpass_____s
0x00272cb4 str.m___s_notls__0_1___:_s
0x00272e4c str.rpcuser__s_rpcpass__s
0x00272edc str.notls__s
0x00273460 str.http
0x0027347c str.:
0x00273514 str.POST
0x00273574 str.Content_Type
0x002735b4 str.application_json
0x0027373c str.error_reading_json_reply:__v
0x00273834 str.d__s
0x002738bc str.s
0x00273a58 str.https
0x00273b18 str.d._d._d
0x00273b20 str.
0x00273b50 str.beta
0x00273c20 str.s__s
0x00273d74 str.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz
0x00273efc str.linux
0x00273f0c str.btcd
0x00273f50 str.linux
0x00273f60 str.btcctl
0x00273fa4 str.linux
0x00273fb4 str.btcwallet
0x0027401c str.btcctl.conf
0x00274090 str.rpc.cert
0x00274098 str.
0x00274104 str.rpc.cert
0x0027410c str.
13586
EOF
RUN

NAME=Resolve all symbols on a linux go1.16 binary (arm64)
FILE=bins/golang/btcctl-linux-arm64-v0.22.0-beta
CMDS=<<EOF
aalg
fl~sym.go.~?
pdfs @ main ~str.
izq~?
EOF
EXPECT=<<EOF
5070
0x0026acd0 str.
0x0026ad08 str.
0x0026b000 str.s_command:__v
0x0026b04c str.1.0
0x0026b29c str.
0x0026b310 str.tls:_invalid_server_key_share
0x0026b314 str.Failed_to_unmarshal_result:__v
0x0026b444 str.Failed_to_format_result:__v
0x0026b5a8 str.
0x0026b5dc str.s_command:__v__code:__s
0x0026b730 str.Failed_to_read_data_from_stdin:__v
0x0026b884 str.Not_enough_lines_provided_on_stdin
0x0026b998 str.The___s__command_can_only_be_used_via_websockets
0x0026b9d0 str.Specify__l_to_list_available_commands
0x0026ba70 str.Unrecognized_command___s
0x0026baa8 str.Specify__l_to_list_available_commands
0x0026bb00 str.No_command_specified
0x0026bb70 str.
0x0026bb9c str.
0x0026bc28 str.Chain_Server_Commands:DEBUG_HTTP2
0x0026bc3c str.Wallet_Server_Commands____wallet_:
0x0026be24 str.
0x0026bee0 str.
0x0026bf1c str.testnet3
0x0026bf40 str.18334
0x0026c030 str.simnet
0x0026c054 str.18556
0x0026c064 str.regtest
0x0026c084 str.18334
0x0026c090 str.cannot_use__wallet_with__regtest__btcwallet_not_yet_compatible_with_regtest
0x0026c100 str.8334
0x0026c140 str.
0x0026c250 str.
0x0026c284 str.
0x0026c2c8 str.localhost
0x0026c2d0 str.localhost
0x0026c34c str.
0x0026c520 str.Use__s__h_to_show_options
0x0026c564 str.
0x0026c5f4 str.btcwallet.conf
0x0026c688 str.Error_creating_a_default_config_file:__v
0x0026c8ac str.testnet3
0x0026c8b4 str.mainnet
0x0026c8c4 str.simnet
0x0026c8d4 str.regtest
0x0026cad4 str.loadConfig
0x0026cae0 str.profilealloc_called_without_a_P_or_outside_bootstrapping
0x0026cae4 str.s:_Multiple_network_params_can_t_be_used_together____choose_one
0x0026cbd0 str.tls:_invalid_server_key_share
0x0026cbd4 str.Error_parsing_config_file:__v
0x0026ccb8 str.btcd.conf
0x0026cd0c str.
0x0026cd6c str.version
0x0026cec4 str.The_special_parameter_____indicates_that_a_parameter_should_be_read_from_the_next_unread_line_from_standard_input.
0x0026cfd0 str.
0x0026d0a8 str.m___s_rpcuser_____s
0x0026d0fc str.m___s_rpcpass_____s
0x0026d150 str.m___s_notls__0_1___:_s
0x0026d2e0 str.rpcuser__s_rpcpass__s
0x0026d368 str.notls__s
0x0026d550 str.
0x0026d580 str.
0x0026d5a0 str.
0x0026d5b8 str.
0x0026d6e0 str.
0x0026d738 str.
0x0026d7c0 str.
0x0026d83c str.
0x0026d8c0 str.
0x0026d8e8 str.
0x0026d900 str.http
0x0026d908 str.https
0x0026d90c str.http
0x0026d928 str.:
0x0026d968 str.
0x0026d9c4 str.POST
0x0026da28 str.Content_Type
0x0026da5c str.
0x0026da64 str.
0x0026da70 str.application_json
0x0026db04 str.
0x0026dbe8 str.error_reading_json_reply:__v
0x0026dc44 str.
0x0026dca0 str.
0x0026dcac str.
0x0026dcec str.d__s
0x0026dd70 str.s
0x0026ddd0 str.
0x0026de48 str.
0x0026df20 str.
0x0026df84 str.d._d._d
0x0026dfc0 str.beta
0x0026e0a0 str.s__s
0x0026e180 str.
0x0026e1dc str.profilealloc_called_without_a_P_or_outside_bootstrapping
0x0026e1e0 str.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz
0x0026e2a0 str.
0x0026e350 str.
0x0026e370 str.linux
0x0026e384 str.btcd
0x0026e3d0 str.linux
0x0026e3e4 str.btcctl
0x0026e430 str.linux
0x0026e444 str.btcwallet
0x0026e4b8 str.btcctl.conf
0x0026e53c str.rpc.cert
0x0026e5c0 str.rpc.cert
0x0026e690 str.
0x0026e6cc str.
0x0026e6d0 str.
0x0026e6e0 str.
0x0026e6e4 str.
15727
EOF
RUN

NAME=Resolve all symbols on a stripped mach0 go1.18 binary (arm64)
FILE=bins/golang/hello.mach0.stripped
CMDS=<<EOF
aalg
fl~sym.go.~?
pdfs @ sym.go.runtime.panicwrap ~str.
izq~?
iI~compiler
EOF
EXPECT=<<EOF
1429
0x100006c70 str.
0x100006dd8 str.value_method
0x100006e48 str.called_using_nil
0x100006e64 str.pointer
0x100006eac str.panicwrap:_no___in
0x100006f10 str.
0x100007280 str.
0x100007420 str.
0x1000074f0 str.
0x100007504 str.
0x10000751c str.
0x10000752c str.
0x1000076d0 str.internal_error___misuse_of_itab
1327
compiler go1.18 (cmd -compiler=gc CGO_ENABLED=1 CGO_CFLAGS= CGO_CPPFLAGS= CGO_CXXFLAGS= CGO_LDFLAGS= GOARCH=arm64 GOOS=darwin)
EOF
RUN
