NAME=PE: corkami 96emptysections.exe - open and analyse
FILE=bins/pe/96emptysections.exe
ARGS=-A
CMDS=q!
EXPECT=<<EOF
EOF
RUN

NAME=PE: corkami 96emptysections.exe - entrypoint
FILE=bins/pe/96emptysections.exe
CMDS=s
EXPECT=<<EOF
0x402000
EOF
RUN

NAME=PE: corkami 96emptysections.exe - entrypoint pif
BROKEN=1
FILE=bins/pe/96emptysections.exe
CMDS=<<EOF
aaa
pif @ entry0
EOF
EXPECT=<<EOF
push 0x402028
call sub.msvcrt.dll_printf_18
add esp, 4
push 0
call sub.kernel32.dll_ExitProcess_1e
EOF
RUN

NAME=PE: corkami 96workingsections.exe - sections list
FILE=bins/pe/96emptysections.exe
ARGS=-n
CMDS=!rz-bin -pS bins/pe/96emptysections.exe
EXPECT=<<EOF
[Sections]
paddr      size  vaddr      vsize  align perm name    type flags 
-----------------------------------------------------------------
0x00001200 0x200 0x00001200 0x1000 0x0   -rwx sect_0       
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_1       
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_2       
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_3       
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_4       
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_5       
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_6       
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_7       
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_8       
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_9       
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_10      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_11      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_12      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_13      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_14      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_15      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_16      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_17      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_18      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_19      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_20      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_21      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_22      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_23      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_24      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_25      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_26      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_27      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_28      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_29      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_30      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_31      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_32      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_33      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_34      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_35      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_36      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_37      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_38      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_39      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_40      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_41      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_42      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_43      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_44      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_45      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_46      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_47      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_48      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_49      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_50      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_51      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_52      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_53      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_54      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_55      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_56      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_57      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_58      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_59      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_60      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_61      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_62      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_63      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_64      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_65      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_66      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_67      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_68      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_69      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_70      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_71      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_72      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_73      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_74      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_75      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_76      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_77      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_78      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_79      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_80      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_81      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_82      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_83      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_84      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_85      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_86      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_87      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_88      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_89      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_90      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_91      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_92      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_93      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_94      
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_95      

EOF
RUN
