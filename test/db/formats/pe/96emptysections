NAME=PE: corkami 96emptysections.exe - open and analyse
FILE=bins/pe/96emptysections.exe
ARGS=-A
CMDS=q!
EXPECT=<<EOF
EOF
RUN

NAME=PE: corkami 96emptysections.exe - entrypoint
FILE=bins/pe/96emptysections.exe
CMDS=s
EXPECT=<<EOF
0x402000
EOF
RUN

NAME=PE: corkami 96emptysections.exe - entrypoint pif
BROKEN=1
FILE=bins/pe/96emptysections.exe
CMDS=<<EOF
aaa
pif @ entry0
EOF
EXPECT=<<EOF
push 0x402028
call sub.msvcrt.dll_printf_18
add esp, 4
push 0
call sub.kernel32.dll_ExitProcess_1e
EOF
RUN

NAME=PE: corkami 96workingsections.exe - sections list
FILE=bins/pe/96emptysections.exe
ARGS=-n
CMDS=!rz-bin -pS bins/pe/96emptysections.exe
EXPECT=<<EOF
[Sections]
paddr      size  vaddr      vsize  align perm name    type flags                
--------------------------------------------------------------------------------
0x00001200 0x200 0x00001200 0x1000 0x0   -rwx sect_0       MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_1       TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_2       TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_3       TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_4       TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_5       TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_6       TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_7       TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_8       TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_9       TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_10      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_11      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_12      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_13      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_14      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_15      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_16      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_17      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_18      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_19      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_20      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_21      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_22      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_23      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_24      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_25      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_26      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_27      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_28      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_29      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_30      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_31      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_32      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_33      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_34      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_35      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_36      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_37      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_38      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_39      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_40      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_41      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_42      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_43      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_44      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_45      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_46      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_47      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_48      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_49      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_50      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_51      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_52      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_53      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_54      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_55      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_56      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_57      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_58      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_59      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_60      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_61      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_62      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_63      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_64      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_65      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_66      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_67      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_68      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_69      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_70      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_71      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_72      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_73      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_74      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_75      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_76      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_77      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_78      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_79      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_80      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_81      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_82      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_83      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_84      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_85      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_86      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_87      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_88      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_89      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_90      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_91      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_92      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_93      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_94      TYPE_REG,MEM_NO_READ
0x00000000 0x0   0x00000000 0x1000 0x0   ---- sect_95      TYPE_REG,MEM_NO_READ

EOF
RUN
